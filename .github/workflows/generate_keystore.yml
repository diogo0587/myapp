name: Generate Android Keystore (One-Time Setup)

on:
  workflow_dispatch:

jobs:
  generate-keystore:
    runs-on: ubuntu-latest

    steps:
      - name: Generate keystore and print base64 + credentials
        run: |
          # Par√¢metros fixos (podem ser alterados, mas precisam bater com os secrets depois)
          PASSWORD="MyAppStrongPass#2025"
          ALIAS="myapp"

          echo "Gerando keystore com alias '$ALIAS'..."
          keytool -genkeypair -v \
            -keystore myapp-release-key.jks \
            -storepass "$PASSWORD" \
            -keypass "$PASSWORD" \
            -keyalg RSA \
            -keysize 2048 \
            -validity 36500 \
            -alias "$ALIAS" \
            -dname "CN=MyApp, OU=MyOrg, O=MyOrg, L=SaoPaulo, ST=SP, C=BR"

          echo ""
          echo "----- BEGIN MYAPP_KEYSTORE_BASE64 -----"
          base64 myapp-release-key.jks
          echo "----- END MYAPP_KEYSTORE_BASE64 -----"
          echo ""
          echo "Use estes valores como GitHub Secrets:"
          echo "MYAPP_KEYSTORE_BASE64 = (tudo entre BEGIN/END acima)"
          echo "MYAPP_KEYSTORE_PASSWORD = $PASSWORD"
          echo "MYAPP_KEY_ALIAS = $ALIAS"
          echo "MYAPP_KEY_PASSWORD = $PASSWORD"